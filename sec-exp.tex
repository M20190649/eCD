\newcommand{\dblp}{{\sc Dblp}\xspace}
\newcommand{\hosp}{{\sc Hosp}\xspace}
\newcommand{\hcahps}{{\sc hcahps}\xspace}



\section{Experimental Study}
\label{sec-exp}
%\vspace{-1ex}

We next present an experimental study of \pCFDs and \pCINDs. Using real-life data, we conducted two sets of experiments to evaluate the efficiency and effectiveness of \pCFDs and \pCINDs vs. their counterparts \CFDs and \CINDs, separately and taken together.

\subsection{Experimental Settings}
%\vspace{-0.5ex}
We first present our experimental settings.

\stitle{Datasets}. We used two real-life datasets that were stored in an SQL Server 2012 database.

\ni(1) \hosp (Hospital Compare) is a database publicly available from U.S. Department of Health %\at{HCAHPS} and \at{HCAHPS}-\at{State}
\& Human Services~\cite{hosp}. We used two tables \at{hcahps} and \at{hcahps}-\at{state}, which record the hospital level and state level ratings of the Hospital Consumer Assessment of Healthcare Providers and Systems (HCAHPS), respectively.
%
For table \at{hcahps}, it records (a) the hospital information: \at{hid} (hospital ID), \at{hname} (hospital name), \at{addr} (address), \at{city}, \at{state}, \at{zip}, \at{county}, \at{phn} (phone number), and (b) the measure information: \at{mid} (measure ID), \at{mq} (question), \at{mad} (answer description), \at{map} (answer percent), \at{mncs} (number of completed surveys), \at{msrrp} (survey response rate percent), \at{mfn} (footnote).
%
And for table \at{hcahps}-\at{state}, it records state level measure information: \at{state}, \at{mid}, \at{mq} and \at{map}, among other things.


We designed 6 \pCFDs and 3 \pCINDs for \hosp, shown below in an informal way for easy of understanding.

\begin{footnotesize}\mat{0ex}{
$\varphi _1 $: \= \at{hcahps}(\at{zip} = `\_' \And \at{city} = `\_' $\rightarrow$ \at{state} = `\_') \\
$\varphi _2 $: \at{hcahps}(\at{hid} = `\_' $\rightarrow$ \at{hname} = `\_' \And \at{county} = `\_' \And \at{addr} = `\_' \And \\
\>  \at{phn}=  `\_') \\
$\varphi _3 $: \at{hcahps}(\at{hid} = `\_' $\rightarrow$ \at{msrrp} = `\_') \\
$\varphi _4 $: \at{hcahps}(\at{hid} = `\_' $\rightarrow$ \at{mq} = `\_' \And \at{mad} = '\_') \\
$\varphi _5 $: \at{hcahps}(\at{hid} = `\_' \And \at{mncs} = `Not Available' $\rightarrow$ \at{mfn} $\geq 1$ \And \at{mfn} $\leq 14$) \\
$\varphi _6 $: \at{hcahps}(\at{hid} = `\_' \And \at{mid} = `\_' \And \at{mncs} $\neq$ `Not Available' \And \\
\> \at{mncs} $\neq$ `Fewer than 100' $\rightarrow$ \at{map} $\geq 0$ \And \at{map} $\leq 100$) \\
$\psi _1 $: \at{hcahps}(\at{mid}, \at{mq}; \at{nil}) $\subseteq$ \at{hcahps}-\at{state}(\at{mid}, \at{mq}; \at{nil}) \\
$\psi _2 $: \at{hcahps}(\at{mid}, \at{state}; \at{nil}) $\subseteq$ \at{hcahps}-\at{state}(\at{mid}, \at{state}; \at{nil}) \\
$\psi _3 $: \at{hcahps}(\at{mid}, \at{state}; \at{mncs}$\neq$ 'Not Available') $\subseteq$ \at{hcahps}-\at{state}(\at{mid}, \at{state}; \\
\> \at{map} $\geq 0$ \And \at{map} $\leq 100$)}
\end{footnotesize}

For comparison, we also designed the \CFDs and \CINDs counterparts of the above \pCFDs and \pCINDs. Here
$\varphi_1$-$\varphi_4 $ and $\psi_1 $-$\psi_2 $ are indeed \CFDs and \CINDs, respectively, while $\varphi_5$, $\varphi_6$ and $\psi_3$ cannot.
We hence further designed $\varphi_5'$, $\varphi_6'$ and $\psi_3'$ to approximate $\varphi_5$, $\varphi_6$ and $\psi_3$, respectively.

\begin{footnotesize}\mat{0ex}{
$\varphi_5'$: \=\at{hcahps}(\at{hid} = `\_' \And \at{mncs} = `\_' $\rightarrow$ \at{mfn} = `\_') \\
$\varphi_6'$: \at{hcahps}(\at{hid} = `\_' \And \at{mid} = `\_' \And \at{mncs} = `\_' $\rightarrow$ \at{map} = `\_') \\
$\psi_3'$: \at{hcahps}(\at{mid}, \at{state}; \at{mncs} = `\_') $\subseteq$ \at{hcahps}-\at{state}(\at{mid}, \at{state}; \at{map} = `\_')
}
\end{footnotesize}


\ni(2) \dblp is a repository of computer science publications from 1946 to 2014~\cite{dblp}.
 We further transformed its XML format into two tables  \at{paper} and \at{proceeding} that record the paper and proceeding information, respectively,
such that \at{paper}(\at{key}, \at{type}, \at{title}, \at{booktitle}, \at{year}, \at{crossref}, \at{isbn}, \at{publisher}) records books, journal articles and conference papers, and \at{proceeding}(\at{key}, \at{year}, \at{isbn}, \at{publisher}) records the proceedings of conference papers, respectively.

We generated 3482 \pCFDs and 2568 \pCINDs for the DBLP data, with their representatives shown below.

\begin{footnotesize}\mat{0ex}{
$\phi_1$:  \= \at{paper}(\at{isbn} = '\_' \And \at{booktitle} = '\_' $\rightarrow$ \at{publisher} = '\_') \\
$\phi_2$: \at{paper}(\at{title} = '\_' \And \at{year} = '\_' \And \at{booktitle} = '\_' $\rightarrow$ \at{type} = '\_')  \\
$\phi_3$: \at{paper}(\at{booktitle} = 'CleanDB' $\rightarrow$ \at{year} = 2006) \\
$\phi_4$: \at{paper}(\at{booktitle} = 'VLDB' \And \at{year_L} = '\_' $\rightarrow$ \at{year_R} $\geq$ 1975 \\
\> \at{year_R}  $\leq$ 2007) \\
$\phi_5$: \at{paper}(\at{booktitle} = 'PVLDB' \And \at{year_L} = '\_' $\rightarrow$ \at{year_R} $\geq$ 2008) \\
$\rho_1$: \at{paper}(\at{crossref}, \at{isbn}, \at{publisher}; \at{type} = 'inproceedings' \And \\
\>  \at{booktitle} = 'CIKM-CNIKM') $\subseteq$ \at{proceeding}(\at{key}, \at{isbn}, \at{publisher}; \\
\>  \at{year} = 2009)  \\
$\rho_2$: \at{paper}(\at{crossref}, \at{isbn}, \at{publisher}; \at{type} = 'inproceedings' \And \\
\>  \at{booktitle} = 'VLDB') $\subseteq$ \at{proceeding}(\at{key}, \at{isbn}, \at{publisher}; \\
\>  \at{year} $\geq$ 1975 \And \at{year} $\leq$ 2007)  \\
$\rho_3$: \at{paper}(\at{crossref}, \at{isbn}, \at{publisher}; \at{type} = 'inproceedings' \And \\
\> \at{booktitle} = 'ICDE') $\subseteq$ \at{proceeding}(\at{key}, \at{isbn}, \at{publisher}; \at{year} $\geq$ 1984)
}
\end{footnotesize}

We collected all the \at{booktitle} and corresponding \at{year} from \dblp to generate the other \pCFDs and \pCINDs by instantiating the values of their \at{booktitle} and \at{year} attributes. Observe that $\phi_1$-$\phi_3$ and $\rho _1$ are \CFDs and \CINDs, respectively. For comparison,  we further designed the following \CFDs and \CINDs to approximate $\phi_4$-$\phi_5$ and $\rho_2$-$\rho_3$.

\begin{footnotesize}\mat{0ex}{
$\phi_4'$: \=\at{paper}(\at{booktitle} = 'VLDB' \And \at{year_L} = '\_' $\rightarrow$ \at{year_R} = '\_') \\
$\phi_5'$: \at{paper}(\at{booktitle} = 'PVLDB' \And \at{year_L} = '\_' $\rightarrow$ \at{year_R} = '\_') \\
$\rho_2'$: \at{paper}(\at{crossref}, \at{isbn}, \at{publisher}; \at{type}$=$'inproceedings' \And \\
\> \at{booktitle} = 'VLDB') $\subseteq$ \at{proceeding}(\at{key}, \at{isbn}, \at{publisher}; \at{year} = '\_')\\
$\rho_3'$: \at{paper}(\at{crossref}, \at{isbn}, \at{publisher}; \at{type} = 'inproceedings' \And \\
\> \at{booktitle} = 'ICDE') $\subseteq$ \at{proceeding}(\at{key}, \at{isbn}, \at{publisher}; \at{year} = '\_')
}
\end{footnotesize}


\stitle{Implementation}. All the experiments were run with an SQL Server 2012 database installed on a machine with an Intel Core i5 (3.1GHz) CPU and 8GB of RAM. Each test was repeated 5 times, and the average is reported here.

\subsection{Experimental Results}

%Efficiency of detecting CFDP violations
\begin{figure*}[tb!]
  \centering
  \subfigure[Varying $|I_{1}|$ for HOSP]{\epsfig{file=exp-fig/11a.eps}}  %, height=1.5in, width=1.5in}}
  \quad
  \subfigure[Varying $noise\%$ for HOSP]{\epsfig{file=exp-fig/11b.eps}}
  \quad
  \subfigure[Varying $|I_{1}|$ for DBLP]{\epsfig{file=exp-fig/11c.eps}}
  \quad
  \subfigure[Varying $noise\%$ for DBLP]{\epsfig{file=exp-fig/11d.eps}}
  \caption{Efficiency of detecting \pCFD violations}\label{fig_exp1_cfdp}
\end{figure*}

%Efficiency of detecting CINDP violations
\begin{figure*}[tb!]
  \centering
  \subfigure[Varying $|I_{1}|$ for HOSP]{\epsfig{file=exp-fig/12a.eps}}
  \quad
  \subfigure[Varying $|I_{2}|$ for HOSP]{\epsfig{file=exp-fig/12b.eps}}
  \quad
  \subfigure[Varying $noise\%$ for HOSP]{\epsfig{file=exp-fig/12c.eps}}
  \quad \\
  \subfigure[Varying $|I_{1}|$ for DBLP]{\epsfig{file=exp-fig/12d.eps}}
  \quad
  \subfigure[Varying $|I_{2}|$ for DBLP]{\epsfig{file=exp-fig/12e.eps}}
  \quad
  \subfigure[Varying $noise\%$ for DBLP]{\epsfig{file=exp-fig/12f.eps}}
  \caption{Efficiency of detecting \pCIND violations}\label{fig_exp1_cindp}
\end{figure*}

%Efficiency of detecting CFDP and CINDP violations
\begin{figure*}[tb!]
  \centering
  \subfigure[Varying $|I_{1}|$ for HOSP]{\epsfig{file=exp-fig/13a.eps}}
  \quad
  \subfigure[Varying $|I_{2}|$ for HOSP]{\epsfig{file=exp-fig/13b.eps}}
  \quad
  \subfigure[Varying $noise\%$ for HOSP]{\epsfig{file=exp-fig/13c.eps}}
  \quad \\
  \subfigure[Varying $|I_{1}|$ for DBLP]{\epsfig{file=exp-fig/13d.eps}}
  \quad
  \subfigure[Varying $|I_{2}|$ for DBLP]{\epsfig{file=exp-fig/13e.eps}}
  \quad
  \subfigure[Varying $noise\%$ for DBLP]{\epsfig{file=exp-fig/13f.eps}}

  \caption{Efficiency of detecting \pCFD and \pCIND violations}\label{fig_exp1_both}
\end{figure*}

We next present our findings.
%
Three parameters were used in our tests:
(1) $|I_1|$, the number of tuples in table \at{hcahps} of \hosp or \at{paper} of \dblp,
(2) $|I_2|$, the number of tuples in table \at{hcahps}-\at{state} of \hosp or in \at{proceeding} of \dblp, and
(3) $noise\%$, the percentage of dirty tuples in table \at{hcahps} of \hosp or  \at{paper} of \dblp, ranging from 0\% to 9\%.
A clean copy of \hosp and \dblp is also kept to tell whether a detected tuple is dirty or not.





\stitle{Exp-1: Efficiency}. In this sets of experiments, we evaluated the efficiency of detecting violations of \pCFDs, \pCINDs and both \pCFDs and \pCINDs by comparing the running time with their \CFDs and \CINDs counterparts, respectively.




\noindent Figure~\ref{fig_exp1_cfdp}(a): Fixing $noise\% = 9\%$, we varied $|I_1|$ from 10K to 90K.    \\
Figure~\ref{fig_exp1_cfdp}(b): Fixing $|I_1|=90K$, we varied $noise\%$ from 0\% to 9\%.\\
Figure~\ref{fig_exp1_cfdp}(c): Fixing $noise\% = 9\%$, we varied $|I_1|$ from 100K to 900K.  \\
Figure~\ref{fig_exp1_cfdp}(d): Fixing $|I_1|=900K$, we varied $noise\%$ from 0\% to 9\%.  \\




\noindent Figure~\ref{fig_exp1_cindp}(a): Fixing $noise\% = 9\%$ and $|I_2| = 1.6K$, we varied $|I_1|$ from 10K to 90K. \\
Figure~\ref{fig_exp1_cindp}(b): Fixing $noise\% = 9\%$ and $|I_1| = 90K$, we varied $|I_2|$ from 1K to 1.6K.\\
Figure~\ref{fig_exp1_cindp}(c): Fixing $|I_1| = 90K$ and $|I_2| = 1.6K$, we varied $noise\%$ from 0\% to 9\%.\\
Figure~\ref{fig_exp1_cindp}(d): Fixing $noise\% = 9\%$ and $|I_2| = 16K$, we varied $|I_1|$ from 100K to 900K.\\
Figure~\ref{fig_exp1_cindp}(e): Fixing $noise\% = 9\%$ and $|I_1| = 900K$, we varied $|I_2|$ from 10K to 16K.\\
Figure~\ref{fig_exp1_cindp}(f): Fixing $|I_1| = 900K$ and $|I_2| = 16K$, we varied $noise\%$ from 0\% to 9\%.\\





\noindent Figure~\ref{fig_exp1_both}(a): Fixing $noise\% = 9\%$ and $|I_2| = 1.6K$, we varied $|I_1|$ from 10K to 90K.\\
Figure~\ref{fig_exp1_both}(b): Fixing $noise\% = 9\%$ and $|I_1| = 90K$, we varied $|I_2|$ from 1K to 1.6K.\\
Figure~\ref{fig_exp1_both}(c): Fixing $|I_1| = 90K$ and $|I_2| = 1.6K$, we varied $noise\%$ from 0\% to 9\%.\\
Figure~\ref{fig_exp1_both}(d): Fixing $noise\% = 9\%$ and $|I_2| = 16K$, we varied $|I_1|$ from 100K to 900K.\\
Figure~\ref{fig_exp1_both}(e): Fixing $noise\% = 9\%$ and $|I_1| = 900K$, we varied $|I_2|$ from 10K to 16K.\\
Figure~\ref{fig_exp1_both}(f): Fixing $|I_1| = 900K$ and $|I_2| = 16K$, we varied $noise\%$ from 0\% to 9\%.\\




\stitle{Exp-2: Effectiveness}. In this set of experiments, we verified the effectiveness of our method by comparing the number of true dirty tuples detected by \pCFDs, \pCINDs and both \pCFDs and \pCINDs with their \CFDs and \CINDs counterparts, respectively. Note that changing $|I_{2}|$ might generate more dirty tuples and make it difficulty to distinguish the true dirty tuples and the false dirty tuples. Hence, we do not report its result in this effectiveness study.


For each dirty tuple $t$, an attribute of $t$ in $Y$ of a \pCFD or $X \cup Y_p$ of a \pCIND was changed from a correct to incorrect value.


%Effectiveness of detecting CFDP violations
\begin{figure*}[tb!]
  \centering
  % Requires \usepackage{graphicx}
  \centering
  \subfigure[Varying $|I_{1}|$ for HOSP]{\epsfig{file=exp-fig/21a.eps}}  %, height=1.5in, width=1.5in}}
  \quad
  \subfigure[Varying $noise\%$ for HOSP]{\epsfig{file=exp-fig/21b.eps}}
  \quad
  \subfigure[Varying $|I_{1}|$ for DBLP]{\epsfig{file=exp-fig/21c.eps}}
  \quad
  \subfigure[Varying $noise\%$ for DBLP]{\epsfig{file=exp-fig/21d.eps}}
  \caption{Effectiveness of detecting \pCFD violations}\label{fig_exp2_cfdp}
\end{figure*}

\noindent Figure~\ref{fig_exp2_cfdp}(a): Fixing $noise\% = 9\%$, we varied $|I_1|$ from 10K to 90K.    \\
Figure~\ref{fig_exp2_cfdp}(b): Fixing $|I_1|=90K$, we varied $noise\%$ from 0\% to 9\%.\\
Figure~\ref{fig_exp2_cfdp}(c): Fixing $noise\% = 9\%$, we varied $|I_1|$ from 100K to 900K.  \\
Figure~\ref{fig_exp2_cfdp}(d): Fixing $|I_1|=900K$, we varied $noise\%$ from 0\% to 9\%.  \\


%Effectiveness of detecting CINDP violations
\begin{figure*}[tb!]
  \centering
  % Requires \usepackage{graphicx}
  \centering
  \subfigure[Varying $|I_{1}|$ for HOSP]{\epsfig{file=exp-fig/22a.eps}}  %, height=1.5in, width=1.5in}}
  \quad
  \subfigure[Varying $noise\%$ for HOSP]{\epsfig{file=exp-fig/22b.eps}}
  \quad
  \subfigure[Varying $|I_{1}|$ for DBLP]{\epsfig{file=exp-fig/22c.eps}}
  \quad
  \subfigure[Varying $noise\%$ for DBLP]{\epsfig{file=exp-fig/22d.eps}}
  \caption{Effectiveness of detecting \pCIND violations}\label{fig_exp2_cindp}
\end{figure*}

\noindent Figure~\ref{fig_exp2_cindp}(a): Fixing $noise\% = 9\%$ and $|I_2| = 1.6K$, we varied $|I_1|$ from 10K to 90K.\\
Figure~\ref{fig_exp2_cindp}(b): Fixing $|I_1| = 90K$ and $|I_2| = 1.6K$, we varied $noise\%$ from 0\% to 9\%.\\
Figure~\ref{fig_exp2_cindp}(c): Fixing $noise\% = 9\%$ and $|I_2| = 16K$, we varied $|I_1|$ from 100K to 900K.\\
Figure~\ref{fig_exp2_cindp}(d): Fixing $|I_1| = 900K$ and $|I_2| = 16K$, we varied $noise\%$ from 0\% to 9\%.\\



%Effectiveness of detecting CFDP and CINDP violations
\begin{figure*}[tb!]
  \centering
  % Requires \usepackage{graphicx}
  \subfigure[Varying $|I_{1}|$ for HOSP]{\epsfig{file=exp-fig/23a.eps}}  %, height=1.5in, width=1.5in}}
  \quad
  \subfigure[Varying $noise\%$ for HOSP]{\epsfig{file=exp-fig/23b.eps}}
  \quad
  \subfigure[Varying $|I_{1}|$ for DBLP]{\epsfig{file=exp-fig/23c.eps}}
  \quad
  \subfigure[Varying $noise\%$ for DBLP]{\epsfig{file=exp-fig/23d.eps}}
  \caption{Effectiveness of detecting \pCFD and \pCIND violations}\label{fig_exp2_both}
\end{figure*}

\noindent Figure~\ref{fig_exp2_both}(a): Fixing $noise\% = 9\%$ and $|I_2| = 1.6K$, we varied $|I_1|$ from 10K to 90K.\\
Figure~\ref{fig_exp2_both}(b): Fixing $|I_1| = 90K$ and $|I_2| = 1.6K$, we varied $noise\%$ from 0\% to 9\%.\\
Figure~\ref{fig_exp2_both}(c): Fixing $noise\% = 9\%$ and $|I_2| = 16K$, we varied $|I_1|$ from 100K to 900K.\\
Figure~\ref{fig_exp2_both}(d): Fixing $|I_1| = 900K$ and $|I_2| = 16K$, we varied $noise\%$ from 0\% to 9\%.\\



\stitle{Summary}. The experimental results show the followings.








